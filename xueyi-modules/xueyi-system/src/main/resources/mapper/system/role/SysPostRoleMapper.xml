<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xueyi.system.role.mapper.SysPostRoleMapper">

    <resultMap type="SysPostRole" id="SysPostRoleResult">
        <id     property="postId"      column="post_id"    />
        <result property="roleId"      column="role_id"    />
    </resultMap>

    <select id="selectPostRoleByPostId" parameterType="com.xueyi.system.api.utilTool.SysSearch" resultType="SysPostRole">
        select pr.post_id, pr.role_id from sys_post_role pr
        where pr.post_id = #{search.postId}
        <!-- 数据范围过滤 -->
        ${params.dataScope}
        order by pr.role_id
    </select>

    <select id="countPostRoleByRoleId" parameterType="com.xueyi.system.api.utilTool.SysSearch" resultType="java.lang.Integer">
        select count(1) from sys_post_role pr
        where pr.role_id=#{search.roleId}
        <!-- 数据范围过滤 -->
        ${params.dataScope}
    </select>

    <insert id="batchNewPostRole" parameterType="com.xueyi.system.api.utilTool.SysSearch">
        insert into sys_post_role (post_id, role_id, tenant_id) values
        <foreach item="roleId" collection="search.roleIds" open="(" separator="," close=")">
            (#{Id}, #{roleId}, #{enterpriseId})
        </foreach>
    </insert>

    <insert id="batchPostRole" parameterType="com.xueyi.system.api.utilTool.SysSearch">
        insert into sys_post_role (post_id, role_id, tenant_id) values
        <foreach item="roleId" collection="search.roleIds" open="(" separator="," close=")">
            (#{search.postId}, #{roleId}, #{enterpriseId})
        </foreach>
    </insert>

    <delete id="deletePostRoleByRoleId" parameterType="com.xueyi.system.api.utilTool.SysSearch">
        delete from sys_post_role
        where role_id = #{search.roleId}
        <!-- 数据范围过滤 -->
        ${params.updateScope}
    </delete>

    <delete id="deletePostRoleByPostId" parameterType="com.xueyi.system.api.utilTool.SysSearch">
        delete from sys_post_role
        where post_id = #{search.postId}
        <!-- 数据范围过滤 -->
        ${params.updateScope}
    </delete>

    <delete id="deletePostRoleByIds" parameterType="com.xueyi.system.api.utilTool.SysSearch">
        delete from sys_post_role where post_id in
        <foreach item="postId" collection="search.postIds" open="(" separator="," close=")">
            #{postId}
        </foreach>
        <!-- 数据范围过滤 -->
        ${params.updateScope}
    </delete>
</mapper>
